<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009"
               xmlns:s="library://ns.adobe.com/flex/spark"
               xmlns:mx="library://ns.adobe.com/flex/mx"
               xmlns:validators="com.cenix.louice.shared.ui.components.validators.*"
               xmlns:view="org.everest.flex.ui.views.*"
               xmlns:components="org.everest.flex.ui.components.*"
               close="{close()}"
               minWidth="400"   title="Generate New Internal Sample Orders" xmlns:validators1="org.everest.flex.ui.validators.*">
    <fx:Script>
        <![CDATA[
            import com.cenix.louice.modules.isorequestmember.ui.presenters.IsoRequestMemberPresentationModel;
            
            import mx.managers.PopUpManager;

            [Bindable]
            public var model:IsoRequestMemberPresentationModel;

            // Handle the close button and Cancel button.
            public function close():void {
                PopUpManager.removePopUp(this);
            }

            protected function createIsos(e:Event=null):void{

                formValidator.validateForm();
                if(formValidator.formIsValid){
                    model.generateNewIsos(inputNumberOfIsos.value, inputExcludedRacks.text,  inputRequiredRacks.text);
                    //                    this.close();
                }
            }

        ]]>
    </fx:Script>

    <fx:Declarations>
        <fx:Array id="validators">
            <validators:RackBarcodeValidator source="{inputExcludedRacks}" property="text" required="false"/>
            <validators:TubeBarcodeValidator source="{inputRequiredRacks}" property="text" required="false"/>
        </fx:Array>
        <validators1:FormValidator id="formValidator" validators="{validators}" />
    </fx:Declarations>

    <s:Form id="newMemberForm" width="100%">

        <s:FormItem width="100%" label="Number of ISOs:" required="true">
            <s:HGroup verticalAlign="middle">
                <s:NumericStepper id="inputNumberOfIsos"  minimum="1" maximum="999" value="1"/>
                <s:Label text=" (Total: {model.expected_number_isos})" fontWeight="bold" />
            </s:HGroup>
        </s:FormItem>

        <s:FormItem width="100%" label="Excluded Racks:">
            <components:SmartTextArea id="inputExcludedRacks"
                                      prompt="barcode single or csv list"
                                      restrict="0-9 ," />
        </s:FormItem>

        <s:FormItem width="100%" label="Requested Tubes:">
            <components:SmartTextArea id="inputRequiredRacks"
                                      prompt="barcode single or csv list"
                                      restrict="0-9 ,"/>
        </s:FormItem>

        <s:FormItem>
            <s:HGroup>
                <s:Button label="Create" click="createIsos()"/>
                <s:Button label="Cancel" click="close()"/>
            </s:HGroup>
        </s:FormItem>

    </s:Form>
</s:TitleWindow>